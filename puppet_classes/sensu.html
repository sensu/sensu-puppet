<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Puppet Class: sensu
  
    &mdash; Documentation by YARD 0.9.28
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "puppet_classes::sensu";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../puppet_class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (s)</a> &raquo;
    <span class='title'><span class='object_link'>Puppet Classes</span></span>
     &raquo; 
    <span class="title">sensu</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="puppet_class_list_link"
        href="../puppet_class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Puppet Class: sensu</h1>
<div class="box_info">
  
  
  <dl>
    <dt>Defined in:</dt>
    <dd>
      manifests/init.pp
    </dd>
  </dl>
</div>

  <h2>Summary</h2>
  Base Sensu class

<h2>Overview</h2>
<div class="docstring">
  <div class="discussion">
    <p>This is the main Sensu class</p>

  </div>
</div>


<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>version</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;installed&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Version of Sensu to install.  Defaults to <code>installed</code> to support
Windows MSI packaging and to avoid surprising upgrades.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>etc_dir</span>
      
      
        <span class='type'>(<tt>Stdlib::Absolutepath</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;/etc/sensu&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Absolute path to the Sensu etc directory.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>ssl_dir</span>
      
      
        <span class='type'>(<tt>Stdlib::Absolutepath</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;/etc/sensu/ssl&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Absolute path to the Sensu ssl directory.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>manage_user</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Boolean that determines if sensu user should be managed</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>user</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;sensu&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>User used by sensu services</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>manage_group</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Boolean that determines if sensu group should be managed</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>group</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;sensu&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>User group used by sensu services</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>etc_dir_purge</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Boolean to determine if the etc_dir should be purged
such that only Puppet managed files are present.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>ssl_dir_purge</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Boolean to determine if the ssl_dir should be purged
such that only Puppet managed files are present.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>manage_repo</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Boolean to determine if software repository for Sensu
should be managed.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>use_ssl</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Sensu backend service uses SSL</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>ssl_ca_source</span>
      
      
        <span class='type'>(<tt>Optional[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>$facts[&#39;puppet_localcacert&#39;]</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Source of SSL CA used by sensu services
This parameter is mutually exclusive with ssl_ca_content</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>ssl_ca_content</span>
      
      
        <span class='type'>(<tt>Optional[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Content of SSL CA used by sensu services
This parameter is mutually exclusive with ssl_ca_source</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>api_host</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>$trusted[&#39;certname&#39;]</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Sensu backend host used to configure sensuctl and verify API access.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>api_port</span>
      
      
        <span class='type'>(<tt>Stdlib::Port</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>8080</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Sensu backend port used to configure sensuctl and verify API access.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>password</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;P@ssw0rd!&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Sensu backend admin password used to confiure sensuctl.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>agent_password</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;P@ssw0rd!&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The sensu agent password</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>agent_entity_config_password</span>
      
      
        <span class='type'>(<tt>Optional[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The password used when configuring Sensu Agent entity config items
Defaults to value used for <code>agent_password</code>.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>validate_namespaces</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Determines if sensuctl and sensu_api types will validate their namespace exists</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>validate_api</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Determines if Sensu API is validated</p>
</div>
      
    </li>
  
</ul>



</div><div class="method_details_list">
  <table class="source_code">
    <tr>
      <td>
        <pre class="lines">


65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155</pre>
      </td>
      <td>
        <pre class="code"><span class="info file"># File 'manifests/init.pp', line 65</span>

class sensu (
  String $version = &#39;installed&#39;,
  Stdlib::Absolutepath $etc_dir = &#39;/etc/sensu&#39;,
  Stdlib::Absolutepath $ssl_dir = &#39;/etc/sensu/ssl&#39;,
  Boolean $manage_user = true,
  String $user = &#39;sensu&#39;,
  Boolean $manage_group = true,
  String $group = &#39;sensu&#39;,
  Boolean $etc_dir_purge = true,
  Boolean $ssl_dir_purge = true,
  Boolean $manage_repo = true,
  Boolean $use_ssl = true,
  Optional[String] $ssl_ca_source = $facts[&#39;puppet_localcacert&#39;],
  Optional[String] $ssl_ca_content = undef,
  String $api_host = $trusted[&#39;certname&#39;],
  Stdlib::Port $api_port = 8080,
  String $password = &#39;P@ssw0rd!&#39;,
  String $agent_password = &#39;P@ssw0rd!&#39;,
  Optional[String] $agent_entity_config_password = undef,
  Boolean $validate_namespaces = true,
  Boolean $validate_api = true,
) {

  if $ssl_ca_content {
    $_ssl_ca_source = undef
  } else {
    $_ssl_ca_source = $ssl_ca_source
  }
  if $use_ssl and !($_ssl_ca_source or $ssl_ca_content) {
    fail(&#39;sensu: ssl_ca_source or ssl_ca_content must be defined when use_ssl is true&#39;)
  }

  if $facts[&#39;os&#39;][&#39;family&#39;] == &#39;windows&#39; {
    # dirname can not handle back slashes so convert to forward slash then back to back slash
    $etc_dir_fixed = regsubst($etc_dir, &#39;\\\\&#39;, &#39;/&#39;, &#39;G&#39;)
    $etc_parent_dirname = dirname($etc_dir_fixed)
    $etc_parent_dir = regsubst($etc_parent_dirname, &#39;/&#39;, &#39;\\\\&#39;, &#39;G&#39;)
    $sensu_user = undef
    $sensu_group = undef
    $directory_mode = undef
    $file_mode = undef
    $trusted_ca_file_path = &quot;${ssl_dir}\\ca.crt&quot;
    $agent_config_path = &quot;${etc_dir}\\agent.yml&quot;
  } else {
    $etc_parent_dir = undef
    $sensu_user = $user
    $sensu_group = $group
    $directory_mode = &#39;0755&#39;
    $file_mode = &#39;0640&#39;
    $join_path = &#39;/&#39;
    $trusted_ca_file_path = &quot;${ssl_dir}/ca.crt&quot;
    $agent_config_path = &quot;${etc_dir}/agent.yml&quot;
  }

  if $use_ssl {
    $api_protocol = &#39;https&#39;
    $trusted_ca_file = $trusted_ca_file_path
  } else {
    $api_protocol = &#39;http&#39;
    $trusted_ca_file = &#39;absent&#39;
  }
  $api_url = &quot;${api_protocol}://${api_host}:${api_port}&quot;

  $_agent_entity_config_password = pick($agent_entity_config_password, $agent_password)

  case $facts[&#39;os&#39;][&#39;family&#39;] {
    &#39;RedHat&#39;: {
      $os_package_require = []
    }
    &#39;Debian&#39;: {
      $os_package_require = [Class[&#39;apt::update&#39;]]
    }
    &#39;windows&#39;: {
      $os_package_require = []
    }
    default: {
      fail(&quot;Detected osfamily &lt;${facts[&#39;os&#39;][&#39;family&#39;]}&gt;. Only RedHat, Debian and Windows are supported.&quot;)
    }
  }

  # $package_require is used by sensu::agent and sensu::backend
  # package resources
  if $manage_repo {
    $package_require = [Class[&#39;sensu::repo&#39;]] + $os_package_require
  } else {
    $package_require = undef
  }

  include sensu::resources

}</pre>
      </td>
    </tr>
  </table>
</div>
</div>

      <div id="footer">
     Generated by <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>.
</div>

    </div>
  </body>
</html>